 	 select max(DECODE(NVL(get_fromdate(dr3.risk_id),'0'),'0',' ',format_date(get_fromdate(dr3.risk_id),'dd/MM/yyyy'))) as "INCEPTION_DATE",   
							   max(DECODE(NVL(GET_ENDO_CREATED_ON(dr3.PERSONAL_PROJECT_ID),'0'),'0',' ',format_date(GET_ENDO_CREATED_ON(dr3.PERSONAL_PROJECT_ID),'dd/MM/yyyy'))) as "Endorsement_creation_date",   
							   pp.PERSONAL_PROJECT_ID as personalp,rnp.RISK_INSURER_ID,   
							   dr3.RISK_REFERENCE as layer_Reference,r.DESCRIPTION as DESCRIPTION,dr3.New_umr as new_umr,dr3.PARENT_RISK_TYPE as risk_type,am.AMENDMENT_NUMBER as Endorsement_NUMBER, am.TITLE as Endorsement_Title,   
							   format_date(bd1.TIME_STAMP,'dd/MM/yyyy') as Effective_from, format_date(bd2.TIME_STAMP,'dd/MM/yyyy') as Effective_to,   
							   dr3.COMPANY_ID as Broker_COMPANY_ID,dr3.COMPANY_NAME as Broker_COMPANY_NAME,dr3.BUYER_USER as broker_name,dr3.BROKER_EMAIL_ADDRESS as broker_email,   
							   ud.USER_ID as uw_id, (ud.first_name || ' ' || ud.surname)  as UW_name, u.USERNAME_TEMP,u.COMPANY_ID,c.COMPANY_NAME,   
							   EP.PARTICIPANT_TYPE as PARTICIPANT_TYPE,   
							   dr3.CMC_CLIENT_NAME as Oridinal_Insured,   
							   rs.SYNDICATE_NAME as SYNDICATE_NAME,   
							   s.STATUS_IMAGE as status,   
							   r.MAIN_CLASS as class_of_business,rt.ACORD_TYPE_NAME as risk_type1   
							   from dr_tab3 dr3   
							   join Risk r on r.RISK_ID= dr3.risk_id   
							   join amendment AM on dr3.RISK_ID=am.risk_id   
							   join RISK_NEGOTIATION_PROJECT rnp on rnp.risk_id=dr3.risk_id   
							   join risk_type rt on r.RISK_TYPE_ID=rt.RISK_TYPE_ID   
							   join AMENDMENT_NEGOTIATE_PROJ anp on am.RISK_ID=anp.RISK_ID   
							   join ENDORSEMENT_PARTICIPANTS EP on (rnp.RISK_NEGOTIATION_PROJECT_ID=EP.RNP_ID  and am.AMENDMENT_ID=ep.AMENDMENT_ID   and anp.AMENDMENT_NEGOTIATE_PROJ_ID=EP.ANP_ID )   
							   JOIN PERSONAL_PROJECT pp on anp.PERSONAL_PROJECT_ID = pp.PERSONAL_PROJECT_ID   
							   join STATUS S on S.STATUS_ID= pp.STATUS_ID   
							   join users u on pp.PROJECT_OWNER = u.USER_ID   
							   join user_detail ud on ud.USER_ID=u.USER_ID   
							   join COMPANY c on u.COMPANY_ID= c.COMPANY_ID   
							   join RISK_INSURER_SYNDICATE_DETAIL risd on rnp.RISK_INSURER_ID=risd.RISK_INSURER_ID   
							   join REINSURER_SYNDICATE rs on risd.REINSURER_SYNDICATE_ID=rs.REINSURER_SYNDICATE_ID   
							   left join BUSINESS_DATE BD1 on BD1.ID=AM.FROMDATE   
							   left join BUSINESS_DATE BD2 on BD2.ID=AM.TODATE   
							   where  dr3.RISK_ID  = :RiskID and anp.NEGOTIATE_TYPE='insurer'  and am.AMENDMENT_NUMBER=:AmmID   
							   group by dr3.RISK_ID, dr3.BROKER_EMAIL_ADDRESS, r.MAIN_CLASS, dr3.RISK_REFERENCE, dr3.umr,    
							   dr3.new_umr, dr3.COMPANY_ID, dr3.COMPANY_NAME, dr3.BUYER_USER, dr3.CMC_INSURED,    
							   am.AMENDMENT_NUMBER, am.TITLE, format_date(bd1.TIME_STAMP,'dd/MM/yyyy'), pp.PERSONAL_PROJECT_ID, format_date(bd2.TIME_STAMP,'dd/MM/yyyy'),    
							   r.DESCRIPTION, dr3.PARENT_RISK_TYPE, rt.ACORD_TYPE_NAME, rnp.RISK_INSURER_ID, EP.PARTICIPANT_TYPE,    
							   s.STATUS_IMAGE, dr3.CMC_CLIENT_NAME, u.USERNAME_TEMP, u.COMPANY_ID, c.COMPANY_NAME,    
							   rs.SYNDICATE_NAME, ud.first_name, ud.surname,ud.USER_ID  ";
							  